-- standard setup
CREATE SERVER kafka_server
FOREIGN DATA WRAPPER kafka_fdw
OPTIONS (brokers 'localhost:9092');
CREATE USER MAPPING FOR PUBLIC SERVER kafka_server;
CREATE FOREIGN TABLE kafka_test (
    part int OPTIONS (partition 'true'),
    offs bigint OPTIONS (offset 'true'),
    some_int int,
    some_text text,
    some_date date,
    some_time timestamp
)
SERVER kafka_server OPTIONS 
    (format 'csv', topic 'contrib_regress', batch_size '30', buffer_delay '100');
-- check that we parse the queries right or error out if needed 
EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE offs = 1 AND part = 0;
              QUERY PLAN               
---------------------------------------
 Foreign Scan on kafka_test
   Filter: ((offs = 1) AND (part = 0))
   Kafka topic: contrib_regress
   scanning: PARTITION = 0 OFFSET 1 
(4 rows)

EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE part=1 AND some_int = 3 AND offs > 4 AND offs > 10 AND offs < 100;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on kafka_test
   Filter: ((offs > 4) AND (offs > 10) AND (offs < 100) AND (part = 1) AND (some_int = 3))
   Kafka topic: contrib_regress
   scanning: PARTITION = 1 OFFSET 11 
(4 rows)

EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE (part,offs)=(1,1) OR (part,offs)=(2,1);
ERROR:  scanning of multiple partitions not allowed
EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE (part,offs) IN((1,1),(2,2)) ;
ERROR:  scanning of multiple partitions not allowed
EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE (part,offs) IN((1,1),(1,2)) ;
ERROR:  scanning of multiple offsets not allowed
EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE some_int = 5 ;
ERROR:  offset and partition must be set in WHERE clause
EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE offs > '5' AND part = '1' ;
                   QUERY PLAN                    
-------------------------------------------------
 Foreign Scan on kafka_test
   Filter: ((offs > '5'::bigint) AND (part = 1))
   Kafka topic: contrib_regress
   scanning: PARTITION = 1 OFFSET 6 
(4 rows)

EXPLAIN (COSTS OFF) SELECT * FROM kafka_test WHERE  '5' < offs AND '1' = part ;
                   QUERY PLAN                    
-------------------------------------------------
 Foreign Scan on kafka_test
   Filter: (('5'::bigint < offs) AND (1 = part))
   Kafka topic: contrib_regress
   scanning: PARTITION = 1 OFFSET 6 
(4 rows)

-- check that we really have messages
SELECT SUM(count) FROM (
SELECT COUNT(*) FROM kafka_test WHERE part = 0 AND offs >= 0
UNION ALL
SELECT COUNT(*) FROM kafka_test WHERE part = 1 AND offs >= 0
UNION ALL
SELECT COUNT(*) FROM kafka_test WHERE part = 2 AND offs >= 0
UNION ALL
SELECT COUNT(*) FROM kafka_test WHERE part = 3 AND offs >= 0
UNION ALL
SELECT COUNT(*) FROM kafka_test WHERE part = 4 AND offs >= 0
)t;
NOTICE:  kafka_fdw has reached the end of the queue
NOTICE:  kafka_fdw has reached the end of the queue
NOTICE:  kafka_fdw has reached the end of the queue
NOTICE:  kafka_fdw has reached the end of the queue
  sum   
--------
 100000
(1 row)

-- see that we can properly parse messages
SELECT * FROM kafka_test WHERE part = 0 AND offs > 10 LIMIT 60;
 part | offs | some_int |                some_text                | some_date  |        some_time         
------+------+----------+-----------------------------------------+------------+--------------------------
    0 |   11 |      461 | It's some text, that is for number 461  | 01-01-2015 | Thu Jan 01 00:07:41 2015
    0 |   12 |      501 | It's some text, that is for number 501  | 01-01-2015 | Thu Jan 01 00:08:21 2015
    0 |   13 |      541 | It's some text, that is for number 541  | 01-01-2015 | Thu Jan 01 00:09:01 2015
    0 |   14 |      581 | It's some text, that is for number 581  | 01-01-2015 | Thu Jan 01 00:09:41 2015
    0 |   15 |      621 | It's some text, that is for number 621  | 01-01-2015 | Thu Jan 01 00:10:21 2015
    0 |   16 |      661 | It's some text, that is for number 661  | 01-01-2015 | Thu Jan 01 00:11:01 2015
    0 |   17 |      701 | It's some text, that is for number 701  | 01-01-2015 | Thu Jan 01 00:11:41 2015
    0 |   18 |      741 | It's some text, that is for number 741  | 01-01-2015 | Thu Jan 01 00:12:21 2015
    0 |   19 |      781 | It's some text, that is for number 781  | 01-01-2015 | Thu Jan 01 00:13:01 2015
    0 |   20 |      821 | It's some text, that is for number 821  | 01-01-2015 | Thu Jan 01 00:13:41 2015
    0 |   21 |      861 | It's some text, that is for number 861  | 01-01-2015 | Thu Jan 01 00:14:21 2015
    0 |   22 |      901 | It's some text, that is for number 901  | 01-01-2015 | Thu Jan 01 00:15:01 2015
    0 |   23 |      941 | It's some text, that is for number 941  | 01-01-2015 | Thu Jan 01 00:15:41 2015
    0 |   24 |      981 | It's some text, that is for number 981  | 01-01-2015 | Thu Jan 01 00:16:21 2015
    0 |   25 |     1021 | It's some text, that is for number 1021 | 01-01-2015 | Thu Jan 01 00:17:01 2015
    0 |   26 |     1061 | It's some text, that is for number 1061 | 01-01-2015 | Thu Jan 01 00:17:41 2015
    0 |   27 |     1101 | It's some text, that is for number 1101 | 01-01-2015 | Thu Jan 01 00:18:21 2015
    0 |   28 |     1141 | It's some text, that is for number 1141 | 01-01-2015 | Thu Jan 01 00:19:01 2015
    0 |   29 |     1181 | It's some text, that is for number 1181 | 01-01-2015 | Thu Jan 01 00:19:41 2015
    0 |   30 |     1221 | It's some text, that is for number 1221 | 01-01-2015 | Thu Jan 01 00:20:21 2015
    0 |   31 |     1261 | It's some text, that is for number 1261 | 01-01-2015 | Thu Jan 01 00:21:01 2015
    0 |   32 |     1301 | It's some text, that is for number 1301 | 01-01-2015 | Thu Jan 01 00:21:41 2015
    0 |   33 |     1341 | It's some text, that is for number 1341 | 01-01-2015 | Thu Jan 01 00:22:21 2015
    0 |   34 |     1381 | It's some text, that is for number 1381 | 01-01-2015 | Thu Jan 01 00:23:01 2015
    0 |   35 |     1421 | It's some text, that is for number 1421 | 01-01-2015 | Thu Jan 01 00:23:41 2015
    0 |   36 |     1461 | It's some text, that is for number 1461 | 01-01-2015 | Thu Jan 01 00:24:21 2015
    0 |   37 |     1501 | It's some text, that is for number 1501 | 01-01-2015 | Thu Jan 01 00:25:01 2015
    0 |   38 |     1541 | It's some text, that is for number 1541 | 01-01-2015 | Thu Jan 01 00:25:41 2015
    0 |   39 |     1581 | It's some text, that is for number 1581 | 01-01-2015 | Thu Jan 01 00:26:21 2015
    0 |   40 |     1621 | It's some text, that is for number 1621 | 01-01-2015 | Thu Jan 01 00:27:01 2015
    0 |   41 |     1661 | It's some text, that is for number 1661 | 01-01-2015 | Thu Jan 01 00:27:41 2015
    0 |   42 |     1701 | It's some text, that is for number 1701 | 01-01-2015 | Thu Jan 01 00:28:21 2015
    0 |   43 |     1741 | It's some text, that is for number 1741 | 01-01-2015 | Thu Jan 01 00:29:01 2015
    0 |   44 |     1781 | It's some text, that is for number 1781 | 01-01-2015 | Thu Jan 01 00:29:41 2015
    0 |   45 |     1821 | It's some text, that is for number 1821 | 01-01-2015 | Thu Jan 01 00:30:21 2015
    0 |   46 |     1861 | It's some text, that is for number 1861 | 01-01-2015 | Thu Jan 01 00:31:01 2015
    0 |   47 |     1901 | It's some text, that is for number 1901 | 01-01-2015 | Thu Jan 01 00:31:41 2015
    0 |   48 |     1941 | It's some text, that is for number 1941 | 01-01-2015 | Thu Jan 01 00:32:21 2015
    0 |   49 |     1981 | It's some text, that is for number 1981 | 01-01-2015 | Thu Jan 01 00:33:01 2015
    0 |   50 |     2021 | It's some text, that is for number 2021 | 01-01-2015 | Thu Jan 01 00:33:41 2015
    0 |   51 |     2061 | It's some text, that is for number 2061 | 01-01-2015 | Thu Jan 01 00:34:21 2015
    0 |   52 |     2101 | It's some text, that is for number 2101 | 01-01-2015 | Thu Jan 01 00:35:01 2015
    0 |   53 |     2141 | It's some text, that is for number 2141 | 01-01-2015 | Thu Jan 01 00:35:41 2015
    0 |   54 |     2181 | It's some text, that is for number 2181 | 01-01-2015 | Thu Jan 01 00:36:21 2015
    0 |   55 |     2221 | It's some text, that is for number 2221 | 01-01-2015 | Thu Jan 01 00:37:01 2015
    0 |   56 |     2261 | It's some text, that is for number 2261 | 01-01-2015 | Thu Jan 01 00:37:41 2015
    0 |   57 |     2301 | It's some text, that is for number 2301 | 01-01-2015 | Thu Jan 01 00:38:21 2015
    0 |   58 |     2341 | It's some text, that is for number 2341 | 01-01-2015 | Thu Jan 01 00:39:01 2015
    0 |   59 |     2381 | It's some text, that is for number 2381 | 01-01-2015 | Thu Jan 01 00:39:41 2015
    0 |   60 |     2421 | It's some text, that is for number 2421 | 01-01-2015 | Thu Jan 01 00:40:21 2015
    0 |   61 |     2461 | It's some text, that is for number 2461 | 01-01-2015 | Thu Jan 01 00:41:01 2015
    0 |   62 |     2501 | It's some text, that is for number 2501 | 01-01-2015 | Thu Jan 01 00:41:41 2015
    0 |   63 |     2541 | It's some text, that is for number 2541 | 01-01-2015 | Thu Jan 01 00:42:21 2015
    0 |   64 |     2581 | It's some text, that is for number 2581 | 01-01-2015 | Thu Jan 01 00:43:01 2015
    0 |   65 |     2621 | It's some text, that is for number 2621 | 01-01-2015 | Thu Jan 01 00:43:41 2015
    0 |   66 |     2661 | It's some text, that is for number 2661 | 01-01-2015 | Thu Jan 01 00:44:21 2015
    0 |   67 |     2701 | It's some text, that is for number 2701 | 01-01-2015 | Thu Jan 01 00:45:01 2015
    0 |   68 |     2741 | It's some text, that is for number 2741 | 01-01-2015 | Thu Jan 01 00:45:41 2015
    0 |   69 |     2781 | It's some text, that is for number 2781 | 01-01-2015 | Thu Jan 01 00:46:21 2015
    0 |   70 |     2821 | It's some text, that is for number 2821 | 01-01-2015 | Thu Jan 01 00:47:01 2015
(60 rows)

SELECT * FROM kafka_test WHERE part = 1 AND offs > 100 LIMIT 60;
 part | offs | some_int |                some_text                | some_date  |        some_time         
------+------+----------+-----------------------------------------+------------+--------------------------
    1 |  101 |     4041 | It's some text, that is for number 4041 | 01-01-2015 | Thu Jan 01 01:07:21 2015
    1 |  102 |     4081 | It's some text, that is for number 4081 | 01-01-2015 | Thu Jan 01 01:08:01 2015
    1 |  103 |     4121 | It's some text, that is for number 4121 | 01-01-2015 | Thu Jan 01 01:08:41 2015
    1 |  104 |     4161 | It's some text, that is for number 4161 | 01-01-2015 | Thu Jan 01 01:09:21 2015
    1 |  105 |     4201 | It's some text, that is for number 4201 | 01-01-2015 | Thu Jan 01 01:10:01 2015
    1 |  106 |     4241 | It's some text, that is for number 4241 | 01-01-2015 | Thu Jan 01 01:10:41 2015
    1 |  107 |     4281 | It's some text, that is for number 4281 | 01-01-2015 | Thu Jan 01 01:11:21 2015
    1 |  108 |     4321 | It's some text, that is for number 4321 | 01-01-2015 | Thu Jan 01 01:12:01 2015
    1 |  109 |     4361 | It's some text, that is for number 4361 | 01-01-2015 | Thu Jan 01 01:12:41 2015
    1 |  110 |     4401 | It's some text, that is for number 4401 | 01-01-2015 | Thu Jan 01 01:13:21 2015
    1 |  111 |     4441 | It's some text, that is for number 4441 | 01-01-2015 | Thu Jan 01 01:14:01 2015
    1 |  112 |     4481 | It's some text, that is for number 4481 | 01-01-2015 | Thu Jan 01 01:14:41 2015
    1 |  113 |     4521 | It's some text, that is for number 4521 | 01-01-2015 | Thu Jan 01 01:15:21 2015
    1 |  114 |     4561 | It's some text, that is for number 4561 | 01-01-2015 | Thu Jan 01 01:16:01 2015
    1 |  115 |     4601 | It's some text, that is for number 4601 | 01-01-2015 | Thu Jan 01 01:16:41 2015
    1 |  116 |     4641 | It's some text, that is for number 4641 | 01-01-2015 | Thu Jan 01 01:17:21 2015
    1 |  117 |     4681 | It's some text, that is for number 4681 | 01-01-2015 | Thu Jan 01 01:18:01 2015
    1 |  118 |     4721 | It's some text, that is for number 4721 | 01-01-2015 | Thu Jan 01 01:18:41 2015
    1 |  119 |     4761 | It's some text, that is for number 4761 | 01-01-2015 | Thu Jan 01 01:19:21 2015
    1 |  120 |     4801 | It's some text, that is for number 4801 | 01-01-2015 | Thu Jan 01 01:20:01 2015
    1 |  121 |     4841 | It's some text, that is for number 4841 | 01-01-2015 | Thu Jan 01 01:20:41 2015
    1 |  122 |     4881 | It's some text, that is for number 4881 | 01-01-2015 | Thu Jan 01 01:21:21 2015
    1 |  123 |     4921 | It's some text, that is for number 4921 | 01-01-2015 | Thu Jan 01 01:22:01 2015
    1 |  124 |     4961 | It's some text, that is for number 4961 | 01-01-2015 | Thu Jan 01 01:22:41 2015
    1 |  125 |     5001 | It's some text, that is for number 5001 | 01-01-2015 | Thu Jan 01 01:23:21 2015
    1 |  126 |     5041 | It's some text, that is for number 5041 | 01-01-2015 | Thu Jan 01 01:24:01 2015
    1 |  127 |     5081 | It's some text, that is for number 5081 | 01-01-2015 | Thu Jan 01 01:24:41 2015
    1 |  128 |     5121 | It's some text, that is for number 5121 | 01-01-2015 | Thu Jan 01 01:25:21 2015
    1 |  129 |     5161 | It's some text, that is for number 5161 | 01-01-2015 | Thu Jan 01 01:26:01 2015
    1 |  130 |     5201 | It's some text, that is for number 5201 | 01-01-2015 | Thu Jan 01 01:26:41 2015
    1 |  131 |     5241 | It's some text, that is for number 5241 | 01-01-2015 | Thu Jan 01 01:27:21 2015
    1 |  132 |     5281 | It's some text, that is for number 5281 | 01-01-2015 | Thu Jan 01 01:28:01 2015
    1 |  133 |     5321 | It's some text, that is for number 5321 | 01-01-2015 | Thu Jan 01 01:28:41 2015
    1 |  134 |     5361 | It's some text, that is for number 5361 | 01-01-2015 | Thu Jan 01 01:29:21 2015
    1 |  135 |     5401 | It's some text, that is for number 5401 | 01-01-2015 | Thu Jan 01 01:30:01 2015
    1 |  136 |     5441 | It's some text, that is for number 5441 | 01-01-2015 | Thu Jan 01 01:30:41 2015
    1 |  137 |     5481 | It's some text, that is for number 5481 | 01-01-2015 | Thu Jan 01 01:31:21 2015
    1 |  138 |     5521 | It's some text, that is for number 5521 | 01-01-2015 | Thu Jan 01 01:32:01 2015
    1 |  139 |     5561 | It's some text, that is for number 5561 | 01-01-2015 | Thu Jan 01 01:32:41 2015
    1 |  140 |     5601 | It's some text, that is for number 5601 | 01-01-2015 | Thu Jan 01 01:33:21 2015
    1 |  141 |     5641 | It's some text, that is for number 5641 | 01-01-2015 | Thu Jan 01 01:34:01 2015
    1 |  142 |     5681 | It's some text, that is for number 5681 | 01-01-2015 | Thu Jan 01 01:34:41 2015
    1 |  143 |     5721 | It's some text, that is for number 5721 | 01-01-2015 | Thu Jan 01 01:35:21 2015
    1 |  144 |     5761 | It's some text, that is for number 5761 | 01-01-2015 | Thu Jan 01 01:36:01 2015
    1 |  145 |     5801 | It's some text, that is for number 5801 | 01-01-2015 | Thu Jan 01 01:36:41 2015
    1 |  146 |     5841 | It's some text, that is for number 5841 | 01-01-2015 | Thu Jan 01 01:37:21 2015
    1 |  147 |     5881 | It's some text, that is for number 5881 | 01-01-2015 | Thu Jan 01 01:38:01 2015
    1 |  148 |     5921 | It's some text, that is for number 5921 | 01-01-2015 | Thu Jan 01 01:38:41 2015
    1 |  149 |     5961 | It's some text, that is for number 5961 | 01-01-2015 | Thu Jan 01 01:39:21 2015
    1 |  150 |     6001 | It's some text, that is for number 6001 | 01-01-2015 | Thu Jan 01 01:40:01 2015
    1 |  151 |     6041 | It's some text, that is for number 6041 | 01-01-2015 | Thu Jan 01 01:40:41 2015
    1 |  152 |     6081 | It's some text, that is for number 6081 | 01-01-2015 | Thu Jan 01 01:41:21 2015
    1 |  153 |     6121 | It's some text, that is for number 6121 | 01-01-2015 | Thu Jan 01 01:42:01 2015
    1 |  154 |     6161 | It's some text, that is for number 6161 | 01-01-2015 | Thu Jan 01 01:42:41 2015
    1 |  155 |     6201 | It's some text, that is for number 6201 | 01-01-2015 | Thu Jan 01 01:43:21 2015
    1 |  156 |     6241 | It's some text, that is for number 6241 | 01-01-2015 | Thu Jan 01 01:44:01 2015
    1 |  157 |     6281 | It's some text, that is for number 6281 | 01-01-2015 | Thu Jan 01 01:44:41 2015
    1 |  158 |     6321 | It's some text, that is for number 6321 | 01-01-2015 | Thu Jan 01 01:45:21 2015
    1 |  159 |     6361 | It's some text, that is for number 6361 | 01-01-2015 | Thu Jan 01 01:46:01 2015
    1 |  160 |     6401 | It's some text, that is for number 6401 | 01-01-2015 | Thu Jan 01 01:46:41 2015
(60 rows)

SELECT * FROM kafka_test WHERE part = 2 AND offs > 1000 LIMIT 60;
 part | offs | some_int |                some_text                 | some_date  |        some_time         
------+------+----------+------------------------------------------+------------+--------------------------
    2 | 1001 |    40071 | It's some text, that is for number 40071 | 01-01-2015 | Thu Jan 01 11:07:51 2015
    2 | 1002 |    40111 | It's some text, that is for number 40111 | 01-01-2015 | Thu Jan 01 11:08:31 2015
    2 | 1003 |    40151 | It's some text, that is for number 40151 | 01-01-2015 | Thu Jan 01 11:09:11 2015
    2 | 1004 |    40191 | It's some text, that is for number 40191 | 01-01-2015 | Thu Jan 01 11:09:51 2015
    2 | 1005 |    40231 | It's some text, that is for number 40231 | 01-01-2015 | Thu Jan 01 11:10:31 2015
    2 | 1006 |    40271 | It's some text, that is for number 40271 | 01-01-2015 | Thu Jan 01 11:11:11 2015
    2 | 1007 |    40311 | It's some text, that is for number 40311 | 01-01-2015 | Thu Jan 01 11:11:51 2015
    2 | 1008 |    40351 | It's some text, that is for number 40351 | 01-01-2015 | Thu Jan 01 11:12:31 2015
    2 | 1009 |    40391 | It's some text, that is for number 40391 | 01-01-2015 | Thu Jan 01 11:13:11 2015
    2 | 1010 |    40431 | It's some text, that is for number 40431 | 01-01-2015 | Thu Jan 01 11:13:51 2015
    2 | 1011 |    40471 | It's some text, that is for number 40471 | 01-01-2015 | Thu Jan 01 11:14:31 2015
    2 | 1012 |    40511 | It's some text, that is for number 40511 | 01-01-2015 | Thu Jan 01 11:15:11 2015
    2 | 1013 |    40551 | It's some text, that is for number 40551 | 01-01-2015 | Thu Jan 01 11:15:51 2015
    2 | 1014 |    40591 | It's some text, that is for number 40591 | 01-01-2015 | Thu Jan 01 11:16:31 2015
    2 | 1015 |    40631 | It's some text, that is for number 40631 | 01-01-2015 | Thu Jan 01 11:17:11 2015
    2 | 1016 |    40671 | It's some text, that is for number 40671 | 01-01-2015 | Thu Jan 01 11:17:51 2015
    2 | 1017 |    40711 | It's some text, that is for number 40711 | 01-01-2015 | Thu Jan 01 11:18:31 2015
    2 | 1018 |    40751 | It's some text, that is for number 40751 | 01-01-2015 | Thu Jan 01 11:19:11 2015
    2 | 1019 |    40791 | It's some text, that is for number 40791 | 01-01-2015 | Thu Jan 01 11:19:51 2015
    2 | 1020 |    40831 | It's some text, that is for number 40831 | 01-01-2015 | Thu Jan 01 11:20:31 2015
    2 | 1021 |    40871 | It's some text, that is for number 40871 | 01-01-2015 | Thu Jan 01 11:21:11 2015
    2 | 1022 |    40911 | It's some text, that is for number 40911 | 01-01-2015 | Thu Jan 01 11:21:51 2015
    2 | 1023 |    40951 | It's some text, that is for number 40951 | 01-01-2015 | Thu Jan 01 11:22:31 2015
    2 | 1024 |    40991 | It's some text, that is for number 40991 | 01-01-2015 | Thu Jan 01 11:23:11 2015
    2 | 1025 |    41031 | It's some text, that is for number 41031 | 01-01-2015 | Thu Jan 01 11:23:51 2015
    2 | 1026 |    41071 | It's some text, that is for number 41071 | 01-01-2015 | Thu Jan 01 11:24:31 2015
    2 | 1027 |    41111 | It's some text, that is for number 41111 | 01-01-2015 | Thu Jan 01 11:25:11 2015
    2 | 1028 |    41151 | It's some text, that is for number 41151 | 01-01-2015 | Thu Jan 01 11:25:51 2015
    2 | 1029 |    41191 | It's some text, that is for number 41191 | 01-01-2015 | Thu Jan 01 11:26:31 2015
    2 | 1030 |    41231 | It's some text, that is for number 41231 | 01-01-2015 | Thu Jan 01 11:27:11 2015
    2 | 1031 |    41271 | It's some text, that is for number 41271 | 01-01-2015 | Thu Jan 01 11:27:51 2015
    2 | 1032 |    41311 | It's some text, that is for number 41311 | 01-01-2015 | Thu Jan 01 11:28:31 2015
    2 | 1033 |    41351 | It's some text, that is for number 41351 | 01-01-2015 | Thu Jan 01 11:29:11 2015
    2 | 1034 |    41391 | It's some text, that is for number 41391 | 01-01-2015 | Thu Jan 01 11:29:51 2015
    2 | 1035 |    41431 | It's some text, that is for number 41431 | 01-01-2015 | Thu Jan 01 11:30:31 2015
    2 | 1036 |    41471 | It's some text, that is for number 41471 | 01-01-2015 | Thu Jan 01 11:31:11 2015
    2 | 1037 |    41511 | It's some text, that is for number 41511 | 01-01-2015 | Thu Jan 01 11:31:51 2015
    2 | 1038 |    41551 | It's some text, that is for number 41551 | 01-01-2015 | Thu Jan 01 11:32:31 2015
    2 | 1039 |    41591 | It's some text, that is for number 41591 | 01-01-2015 | Thu Jan 01 11:33:11 2015
    2 | 1040 |    41631 | It's some text, that is for number 41631 | 01-01-2015 | Thu Jan 01 11:33:51 2015
    2 | 1041 |    41671 | It's some text, that is for number 41671 | 01-01-2015 | Thu Jan 01 11:34:31 2015
    2 | 1042 |    41711 | It's some text, that is for number 41711 | 01-01-2015 | Thu Jan 01 11:35:11 2015
    2 | 1043 |    41751 | It's some text, that is for number 41751 | 01-01-2015 | Thu Jan 01 11:35:51 2015
    2 | 1044 |    41791 | It's some text, that is for number 41791 | 01-01-2015 | Thu Jan 01 11:36:31 2015
    2 | 1045 |    41831 | It's some text, that is for number 41831 | 01-01-2015 | Thu Jan 01 11:37:11 2015
    2 | 1046 |    41871 | It's some text, that is for number 41871 | 01-01-2015 | Thu Jan 01 11:37:51 2015
    2 | 1047 |    41911 | It's some text, that is for number 41911 | 01-01-2015 | Thu Jan 01 11:38:31 2015
    2 | 1048 |    41951 | It's some text, that is for number 41951 | 01-01-2015 | Thu Jan 01 11:39:11 2015
    2 | 1049 |    41991 | It's some text, that is for number 41991 | 01-01-2015 | Thu Jan 01 11:39:51 2015
    2 | 1050 |    42031 | It's some text, that is for number 42031 | 01-01-2015 | Thu Jan 01 11:40:31 2015
    2 | 1051 |    42071 | It's some text, that is for number 42071 | 01-01-2015 | Thu Jan 01 11:41:11 2015
    2 | 1052 |    42111 | It's some text, that is for number 42111 | 01-01-2015 | Thu Jan 01 11:41:51 2015
    2 | 1053 |    42151 | It's some text, that is for number 42151 | 01-01-2015 | Thu Jan 01 11:42:31 2015
    2 | 1054 |    42191 | It's some text, that is for number 42191 | 01-01-2015 | Thu Jan 01 11:43:11 2015
    2 | 1055 |    42231 | It's some text, that is for number 42231 | 01-01-2015 | Thu Jan 01 11:43:51 2015
    2 | 1056 |    42271 | It's some text, that is for number 42271 | 01-01-2015 | Thu Jan 01 11:44:31 2015
    2 | 1057 |    42311 | It's some text, that is for number 42311 | 01-01-2015 | Thu Jan 01 11:45:11 2015
    2 | 1058 |    42351 | It's some text, that is for number 42351 | 01-01-2015 | Thu Jan 01 11:45:51 2015
    2 | 1059 |    42391 | It's some text, that is for number 42391 | 01-01-2015 | Thu Jan 01 11:46:31 2015
    2 | 1060 |    42431 | It's some text, that is for number 42431 | 01-01-2015 | Thu Jan 01 11:47:11 2015
(60 rows)

SELECT * FROM kafka_test WHERE part = 3 AND offs > 1000 LIMIT 60;
 part | offs | some_int |                some_text                 | some_date  |        some_time         
------+------+----------+------------------------------------------+------------+--------------------------
    3 | 1001 |    40051 | It's some text, that is for number 40051 | 01-01-2015 | Thu Jan 01 11:07:31 2015
    3 | 1002 |    40091 | It's some text, that is for number 40091 | 01-01-2015 | Thu Jan 01 11:08:11 2015
    3 | 1003 |    40131 | It's some text, that is for number 40131 | 01-01-2015 | Thu Jan 01 11:08:51 2015
    3 | 1004 |    40171 | It's some text, that is for number 40171 | 01-01-2015 | Thu Jan 01 11:09:31 2015
    3 | 1005 |    40211 | It's some text, that is for number 40211 | 01-01-2015 | Thu Jan 01 11:10:11 2015
    3 | 1006 |    40251 | It's some text, that is for number 40251 | 01-01-2015 | Thu Jan 01 11:10:51 2015
    3 | 1007 |    40291 | It's some text, that is for number 40291 | 01-01-2015 | Thu Jan 01 11:11:31 2015
    3 | 1008 |    40331 | It's some text, that is for number 40331 | 01-01-2015 | Thu Jan 01 11:12:11 2015
    3 | 1009 |    40371 | It's some text, that is for number 40371 | 01-01-2015 | Thu Jan 01 11:12:51 2015
    3 | 1010 |    40411 | It's some text, that is for number 40411 | 01-01-2015 | Thu Jan 01 11:13:31 2015
    3 | 1011 |    40451 | It's some text, that is for number 40451 | 01-01-2015 | Thu Jan 01 11:14:11 2015
    3 | 1012 |    40491 | It's some text, that is for number 40491 | 01-01-2015 | Thu Jan 01 11:14:51 2015
    3 | 1013 |    40531 | It's some text, that is for number 40531 | 01-01-2015 | Thu Jan 01 11:15:31 2015
    3 | 1014 |    40571 | It's some text, that is for number 40571 | 01-01-2015 | Thu Jan 01 11:16:11 2015
    3 | 1015 |    40611 | It's some text, that is for number 40611 | 01-01-2015 | Thu Jan 01 11:16:51 2015
    3 | 1016 |    40651 | It's some text, that is for number 40651 | 01-01-2015 | Thu Jan 01 11:17:31 2015
    3 | 1017 |    40691 | It's some text, that is for number 40691 | 01-01-2015 | Thu Jan 01 11:18:11 2015
    3 | 1018 |    40731 | It's some text, that is for number 40731 | 01-01-2015 | Thu Jan 01 11:18:51 2015
    3 | 1019 |    40771 | It's some text, that is for number 40771 | 01-01-2015 | Thu Jan 01 11:19:31 2015
    3 | 1020 |    40811 | It's some text, that is for number 40811 | 01-01-2015 | Thu Jan 01 11:20:11 2015
    3 | 1021 |    40851 | It's some text, that is for number 40851 | 01-01-2015 | Thu Jan 01 11:20:51 2015
    3 | 1022 |    40891 | It's some text, that is for number 40891 | 01-01-2015 | Thu Jan 01 11:21:31 2015
    3 | 1023 |    40931 | It's some text, that is for number 40931 | 01-01-2015 | Thu Jan 01 11:22:11 2015
    3 | 1024 |    40971 | It's some text, that is for number 40971 | 01-01-2015 | Thu Jan 01 11:22:51 2015
    3 | 1025 |    41011 | It's some text, that is for number 41011 | 01-01-2015 | Thu Jan 01 11:23:31 2015
    3 | 1026 |    41051 | It's some text, that is for number 41051 | 01-01-2015 | Thu Jan 01 11:24:11 2015
    3 | 1027 |    41091 | It's some text, that is for number 41091 | 01-01-2015 | Thu Jan 01 11:24:51 2015
    3 | 1028 |    41131 | It's some text, that is for number 41131 | 01-01-2015 | Thu Jan 01 11:25:31 2015
    3 | 1029 |    41171 | It's some text, that is for number 41171 | 01-01-2015 | Thu Jan 01 11:26:11 2015
    3 | 1030 |    41211 | It's some text, that is for number 41211 | 01-01-2015 | Thu Jan 01 11:26:51 2015
    3 | 1031 |    41251 | It's some text, that is for number 41251 | 01-01-2015 | Thu Jan 01 11:27:31 2015
    3 | 1032 |    41291 | It's some text, that is for number 41291 | 01-01-2015 | Thu Jan 01 11:28:11 2015
    3 | 1033 |    41331 | It's some text, that is for number 41331 | 01-01-2015 | Thu Jan 01 11:28:51 2015
    3 | 1034 |    41371 | It's some text, that is for number 41371 | 01-01-2015 | Thu Jan 01 11:29:31 2015
    3 | 1035 |    41411 | It's some text, that is for number 41411 | 01-01-2015 | Thu Jan 01 11:30:11 2015
    3 | 1036 |    41451 | It's some text, that is for number 41451 | 01-01-2015 | Thu Jan 01 11:30:51 2015
    3 | 1037 |    41491 | It's some text, that is for number 41491 | 01-01-2015 | Thu Jan 01 11:31:31 2015
    3 | 1038 |    41531 | It's some text, that is for number 41531 | 01-01-2015 | Thu Jan 01 11:32:11 2015
    3 | 1039 |    41571 | It's some text, that is for number 41571 | 01-01-2015 | Thu Jan 01 11:32:51 2015
    3 | 1040 |    41611 | It's some text, that is for number 41611 | 01-01-2015 | Thu Jan 01 11:33:31 2015
    3 | 1041 |    41651 | It's some text, that is for number 41651 | 01-01-2015 | Thu Jan 01 11:34:11 2015
    3 | 1042 |    41691 | It's some text, that is for number 41691 | 01-01-2015 | Thu Jan 01 11:34:51 2015
    3 | 1043 |    41731 | It's some text, that is for number 41731 | 01-01-2015 | Thu Jan 01 11:35:31 2015
    3 | 1044 |    41771 | It's some text, that is for number 41771 | 01-01-2015 | Thu Jan 01 11:36:11 2015
    3 | 1045 |    41811 | It's some text, that is for number 41811 | 01-01-2015 | Thu Jan 01 11:36:51 2015
    3 | 1046 |    41851 | It's some text, that is for number 41851 | 01-01-2015 | Thu Jan 01 11:37:31 2015
    3 | 1047 |    41891 | It's some text, that is for number 41891 | 01-01-2015 | Thu Jan 01 11:38:11 2015
    3 | 1048 |    41931 | It's some text, that is for number 41931 | 01-01-2015 | Thu Jan 01 11:38:51 2015
    3 | 1049 |    41971 | It's some text, that is for number 41971 | 01-01-2015 | Thu Jan 01 11:39:31 2015
    3 | 1050 |    42011 | It's some text, that is for number 42011 | 01-01-2015 | Thu Jan 01 11:40:11 2015
    3 | 1051 |    42051 | It's some text, that is for number 42051 | 01-01-2015 | Thu Jan 01 11:40:51 2015
    3 | 1052 |    42091 | It's some text, that is for number 42091 | 01-01-2015 | Thu Jan 01 11:41:31 2015
    3 | 1053 |    42131 | It's some text, that is for number 42131 | 01-01-2015 | Thu Jan 01 11:42:11 2015
    3 | 1054 |    42171 | It's some text, that is for number 42171 | 01-01-2015 | Thu Jan 01 11:42:51 2015
    3 | 1055 |    42211 | It's some text, that is for number 42211 | 01-01-2015 | Thu Jan 01 11:43:31 2015
    3 | 1056 |    42251 | It's some text, that is for number 42251 | 01-01-2015 | Thu Jan 01 11:44:11 2015
    3 | 1057 |    42291 | It's some text, that is for number 42291 | 01-01-2015 | Thu Jan 01 11:44:51 2015
    3 | 1058 |    42331 | It's some text, that is for number 42331 | 01-01-2015 | Thu Jan 01 11:45:31 2015
    3 | 1059 |    42371 | It's some text, that is for number 42371 | 01-01-2015 | Thu Jan 01 11:46:11 2015
    3 | 1060 |    42411 | It's some text, that is for number 42411 | 01-01-2015 | Thu Jan 01 11:46:51 2015
(60 rows)

SELECT * FROM kafka_test WHERE part = 4 AND offs > 0 LIMIT 60;
 part | offs | some_int | some_text | some_date | some_time 
------+------+----------+-----------+-----------+-----------
(0 rows)

